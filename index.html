<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>魂の誓願と星詠みの祝福</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Shippori+Mincho:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Shippori Mincho', serif;
            background: linear-gradient(145deg, #0b132b 0%, #1c2541 40%, #3a506b 100%); /* 深く神秘的な夜空のグラデーション */
            color: #e0e0e0; /* やや暖かみのある白 */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem;
            box-sizing: border-box;
            overflow-x: hidden;
        }
        .container {
            background-color: rgba(11, 19, 43, 0.88); /* 深いネイビーの半透明背景 */
            backdrop-filter: blur(15px);
            border-radius: 1.25rem; /* 角丸を少し大きく */
            padding: 2.5rem; /* パディングを少し大きく */
            box-shadow: 0 15px 35px rgba(0,0,0,0.5), 0 0 100px rgba(86, 128, 233, 0.25) inset;
            width: 100%;
            max-width: 600px; /* コンテナ幅を少し広げる */
            text-align: center;
            border: 1px solid rgba(86, 128, 233, 0.35); /* 星明かりのような境界線 */
        }
        .title-font {
            font-family: 'Shippori Mincho', serif;
        }
        .button-sacred { /* ボタンのクラス名変更 */
            background: linear-gradient(135deg, #5680e9, #84ceeb); /* 明るく希望に満ちた青のグラデーション */
            color: white;
            padding: 0.9rem 2rem;
            border-radius: 0.85rem;
            font-weight: bold;
            transition: all 0.35s ease;
            border: none;
            cursor: pointer;
            box-shadow: 0 6px 18px rgba(86, 128, 233, 0.35), 0 2px 6px rgba(0,0,0,0.25);
            display: inline-block;
        }
        .button-sacred:hover {
            background: linear-gradient(135deg, #4a6fcf, #70b9d6);
            transform: translateY(-4px) scale(1.04);
            box-shadow: 0 10px 25px rgba(86, 128, 233, 0.45), 0 4px 8px rgba(0,0,0,0.3);
        }
        .input-field, .textarea-field {
            background-color: rgba(28, 37, 65, 0.85); /* より深い色の入力欄背景 */
            border: 1px solid #5a76a8; /* 星影のような境界線 */
            color: #e0e0e0;
            border-radius: 0.6rem;
            padding: 0.9rem;
            width: 100%;
            box-sizing: border-box;
            transition: border-color 0.3s, box-shadow 0.3s;
            margin-bottom: 1rem; /* マージン調整 */
        }
        .input-field:focus, .textarea-field:focus {
            outline: none;
            border-color: #84ceeb; /* フォーカス時は明るい水色 */
            box-shadow: 0 0 0 3px rgba(132, 206, 235, 0.35);
        }
        .label-text {
            display: block;
            margin-bottom: 0.75rem; /* ラベルと入力欄の間隔 */
            text-align: left;
            color: #c0c0c0; /* 少し明るいグレー */
            font-weight: 500; /* やや太字 */
        }
        .message-box, .result-box { /* 結果表示用のクラス追加 */
            background-color: rgba(28, 37, 65, 0.75);
            border-left: 6px solid #84ceeb; /* 左のアクセントラインを太く */
            padding: 2rem; /* パディングを大きく */
            border-radius: 0.85rem;
            margin-top: 2.5rem;
            animation: fadeInContent 1s ease-out forwards;
            text-align: left;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }
        .gofu-box { /* 言霊の護符専用ボックス */
            background: linear-gradient(145deg, rgba(86, 128, 233, 0.15), rgba(132, 206, 235, 0.25));
            border: 1px solid rgba(132, 206, 235, 0.5);
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-top: 1.5rem;
            text-align: center;
            font-family: 'Shippori Mincho', serif;
            font-size: 1.2rem; /* 少し大きく */
            color: #f0f8ff; /* アリスブルー */
            box-shadow: 0 0 15px rgba(132, 206, 235, 0.3);
        }
        @keyframes fadeInContent {
            from { opacity: 0; transform: translateY(25px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .hidden {
            display: none;
        }
        .error-message {
            color: #fda4af; /* ピンク系のエラーメッセージ */
            font-size: 0.9rem;
            margin-top: 0.5rem;
            text-align: left; /* エラーメッセージも左揃え */
        }
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: #a6c0fe; /* 淡い青紫 */
            font-family: 'Shippori Mincho', serif;
        }
        .step-indicator {
            font-size: 0.9rem;
            color: #7f9de0;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="mb-8">
            <h1 class="text-3xl md:text-4xl font-bold title-font text-sky-300">魂の誓願と星詠みの祝福</h1>
        </header>

        <section id="step1Section">
            <h2 class="section-title">星読みの森へようこそ</h2>
            <p class="mb-6 text-slate-300">私はタロットに宿る精霊、ワンと申します。<br>あなたの魂の願いを、この揺らぎの水鏡に映してみませんか？</p>
            
            <label for="nickname" class="label-text">あなたのニックネームを教えていただけますか？</label>
            <input type="text" id="nickname" class="input-field" placeholder="例：さくら">
            <p id="nicknameError" class="error-message hidden">ニックネームを教えてくださいね。</p>

            <label for="soulWish" class="label-text mt-4">あなたの魂からの純粋な願いをお聞かせください。</label>
            <textarea id="soulWish" class="textarea-field h-24" placeholder="例：〇〇さんと心からの愛で結ばれますように…"></textarea>
            <p id="soulWishError" class="error-message hidden">あなたの魂の願いを教えてくださいね。</p>

            <button id="goToStep2" class="button-sacred mt-6">愛の行動を誓う</button>
        </section>

        <section id="step2Section" class="hidden">
            <h2 id="step2Title" class="section-title">愛の行動宣言</h2>
            <p id="step2Greeting" class="mb-6 text-slate-300"></p>
            <p class="mb-4 text-slate-300">その願いを成就させるために、あなたが日々実践する「愛の行動」を３つまで教えてくださいね。<br>小さなことでも大丈夫、あなたの心が示す愛の形を信じて。</p>

            <div>
                <label for="action1" class="label-text">愛の行動 1：</label>
                <input type="text" id="action1" class="input-field" placeholder="例：毎日、彼の幸せを心から祈ります。">
                <p id="action1Error" class="error-message hidden">一つ目の愛の行動を教えてくださいね。</p>
            </div>
            <div class="mt-3">
                <label for="action2" class="label-text">愛の行動 2：(任意)</label>
                <input type="text" id="action2" class="input-field" placeholder="例：自分自身を愛で満たし、笑顔で過ごします。">
            </div>
            <div class="mt-3">
                <label for="action3" class="label-text">愛の行動 3：(任意)</label>
                <input type="text" id="action3" class="input-field" placeholder="例：勇気を出して、感謝の言葉を伝えます。">
            </div>
            <button id="goToStep3" class="button-sacred mt-6">星詠みの祝福を授かる</button>
        </section>

        <section id="step3Section" class="hidden">
            <h2 class="section-title">星詠みの祝福と魂の護符</h2>
            <div id="resultBox" class="result-box">
                </div>
            <button id="returnToStart" class="button-sacred mt-8">もう一度、魂の願いを灯す</button>
        </section>
    </div>

    <footer class="text-center text-xs text-slate-500 mt-8 pb-4">
        <p>&copy; 神式七術 All rights reserved.</p>
        <p class="mt-1">このツールはあなたの内なる力を引き出すためのものであり、結果を保証するものではありません。</p>
    </footer>

    <script>
        // DOM Elements
        const step1Section = document.getElementById('step1Section');
        const nicknameInput = document.getElementById('nickname');
        const soulWishInput = document.getElementById('soulWish');
        const nicknameError = document.getElementById('nicknameError');
        const soulWishError = document.getElementById('soulWishError');
        const goToStep2Button = document.getElementById('goToStep2');

        const step2Section = document.getElementById('step2Section');
        const step2Title = document.getElementById('step2Title');
        const step2Greeting = document.getElementById('step2Greeting');
        const action1Input = document.getElementById('action1');
        const action2Input = document.getElementById('action2');
        const action3Input = document.getElementById('action3');
        const action1Error = document.getElementById('action1Error');
        const goToStep3Button = document.getElementById('goToStep3');

        const step3Section = document.getElementById('step3Section');
        const resultBox = document.getElementById('resultBox');
        const returnToStartButton = document.getElementById('returnToStart');

        // User Data
        let userNickname = "";
        let soulWish = "";
        let actions = [];

        // Star Reading Messages (Moon Phases & Stars)
        const starReadings = [
            (name) => `今宵は新月。新たな始まりのエネルギーが、${name}さんの誓願を力強く後押ししています。蒔かれた種が芽吹くように、あなたの愛の行動が願いを育むでしょう。`,
            (name) => `三日月が空に優しい光を灯していますね。${name}さんの願いは、この月のように日々満ちていくことでしょう。焦らず、一歩ずつ愛を育んでください。`,
            (name) => `上弦の月が、決意と行動の力を象徴しています。${name}さんの「愛の行動宣言」は、この月の力強いサポートを受け、願いの成就へと進むでしょう。`,
            (name) => `満月が、成就と感謝のエネルギーで世界を照らしています。${name}さんの純粋な願いと愛の行動が、この満月の光のように豊かに実を結びますように。`,
            (name) => `下弦の月は、内省と手放しの時。${name}さん、願いを妨げるかもしれない小さな不安は、この月に預けて。あなたの愛は、より軽やかに輝きを増すでしょう。`,
            (name) => `北天に輝く「導きの星」が、${name}さんの進むべき道を明るく照らしています。迷うことなく、その星を目指して愛の行動を続けてくださいね。`,
            (name) => `七色の光を放つ「希望の星団」が、${name}さんの願いに祝福のシャワーを降らせています。あなたの未来は、虹のように美しく輝いていますよ。`,
            (name) => `「絆の双子星」が、今宵はひときわ強く結びつきを強めています。${name}さんの愛の行動は、大切な人との魂の絆をさらに深めることでしょう。`
        ];

        // Gofu (Amulet Words)
        const gofuWords = [
            "私は愛と共に進み、願いを現実にする力を持つ",
            "私の魂は輝き、宇宙の無限の豊かさと繋がっている",
            "日々の愛の行動が、私の願いを確実なものへと導く",
            "私は愛される価値があり、素晴らしい愛を引き寄せる",
            "宇宙は私の味方。全ての出来事は願いの成就へと繋がる",
            "私の心は愛と感謝で満ち溢れ、奇跡を呼び込む",
            "信じる力が、私の未来を美しく創造する",
            "私はありのままで完璧。愛と喜びが私を包む"
        ];

        // Event Listeners
        goToStep2Button.addEventListener('click', () => {
            userNickname = nicknameInput.value.trim();
            soulWish = soulWishInput.value.trim();
            let valid = true;
            if (!userNickname) {
                nicknameError.classList.remove('hidden');
                valid = false;
            } else {
                nicknameError.classList.add('hidden');
            }
            if (!soulWish) {
                soulWishError.classList.remove('hidden');
                valid = false;
            } else {
                soulWishError.classList.add('hidden');
            }

            if (valid) {
                step1Section.classList.add('hidden');
                step2Section.classList.remove('hidden');
                step2Title.textContent = `${userNickname}さんの愛の行動宣言`;
                step2Greeting.innerHTML = `その魂の願い、確かに受け止めました。あなたの想いは、夜空で最も明るく輝く星のように、尊い光を放っていますよ。<br>その光をさらに強め、現実へと手繰り寄せるために、あなたの「愛の行動」を教えてくださいね。`;
            }
        });

        goToStep3Button.addEventListener('click', () => {
            const action1 = action1Input.value.trim();
            const action2 = action2Input.value.trim();
            const action3 = action3Input.value.trim();
            actions = []; // Reset actions

            if (!action1) {
                action1Error.classList.remove('hidden');
                return;
            } else {
                action1Error.classList.add('hidden');
                actions.push(action1);
            }
            if (action2) actions.push(action2);
            if (action3) actions.push(action3);
            
            step2Section.classList.add('hidden');
            step3Section.classList.remove('hidden');
            displayResults();
        });
        
        returnToStartButton.addEventListener('click', () => {
            step3Section.classList.add('hidden');
            step1Section.classList.remove('hidden');
            // Clear inputs for next use
            nicknameInput.value = "";
            soulWishInput.value = "";
            action1Input.value = "";
            action2Input.value = "";
            action3Input.value = "";
            actions = [];
        });

        // Functions
        function displayResults() {
            const randomReading = starReadings[Math.floor(Math.random() * starReadings.length)](userNickname);
            const randomGofu = gofuWords[Math.floor(Math.random() * gofuWords.length)];

            let actionsHtml = "<ul>";
            actions.forEach(action => {
                actionsHtml += `<li class="mb-1 ml-4 list-disc list-inside text-slate-300">${action}</li>`;
            });
            actionsHtml += "</ul>";

            resultBox.innerHTML = `
                <p class="text-lg text-amber-300 mb-3 title-font">${userNickname}さんの魂の誓願、星々に届きました…</p>
                <p class="text-slate-300 mb-2"><strong>あなたの魂の願い：</strong><br>${soulWish}</p>
                <p class="text-slate-300 mb-4"><strong>あなたの愛の行動宣言：</strong>${actionsHtml}</p>
                
                <hr class="border-slate-600 my-6">

                <p class="text-lg text-sky-400 mb-3 title-font">星詠みの祝福</p>
                <p class="text-slate-200 mb-6 leading-relaxed">${randomReading}</p>

                <p class="text-lg text-emerald-400 mb-3 title-font">魂の護符</p>
                <div class="gofu-box">
                    <p>「 ${randomGofu} 」</p>
                </div>
                <p class="text-slate-400 mt-3 text-sm text-center">この言霊を、朝夕に心で唱え、星の守護を感じてくださいね。</p>
                
                <hr class="border-slate-600 my-6">

                <p class="text-slate-400 text-sm leading-relaxed mt-6">
                    ${userNickname}さん、この星詠みと言霊の護符は、あなたの内なる力を引き出し、願いへの道を照らすための、星々のささやきです。
                    魔法のように直接願いを叶えるものではありませんが、あなたの純粋な想いと愛に満ちた行動が、きっと素晴らしい未来を手繰り寄せるでしょう。
                    この森は、いつもあなたの幸せを心から願っていますよ。
                </p>
            `;
        }
    </script>
</body>
</html>
